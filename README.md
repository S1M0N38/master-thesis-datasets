# Datasets

- `datasets/`
  - `CIFAR100/` toy-dataset, 100 classes, 6-level hierarchy
    - `classes/` contains *classes.txt* (each line is a class name)
    - `descriptions/` contains descriptions of classes generated by writers
    - `embeddings/` contains embeddings of descriptions generated by encoders
    - `encodings/` contains encodings (i.e. targets) generated from hierarchy
      or from embeddings by encoders
    - `hierarchy/` contains various representations of the hierarchy
    - `inputs/` empty directory to fill with the actual dataset
      (e.g. soft link to a directory containing images)
  - `iNaturalist19/` 1010 classes, 8-level hierarchy
    - ...
  - `tieredImageNet/` 608 classes, 13-level hierarchy
    - ...
- `embedders/` takes descriptions and produce embeddings
- `encoders/` takes embeddings or hierarchy and produce encodings
- `writers/` generate descriptions of classes from *classes.txt*

## Usage

- `python utils/hierarchy.py` generate *lca.npy* and *hierarchy.npy* for all datasets
- `python utils/classes.py` generate *classes.txt* for all datasets

- `python writers/[writer].py --dataset [DATASET]` generate description of
  class names given the dataset
- `python embedders/[embedders].py --dataset [DATASET] --writer [WRITER]` generate
  embeddings from descriptions given the dataset and the writer

- `python encoders/[encoder].py --dataset [DATASET] {--writer [WRITER]}` generate
  encodings from descriptions embeddings or from hierarchy give the dataset
